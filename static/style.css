/* === Thème beige-green === */
:root{
    --radius: 14px;
  }
  
  body.theme-beige-green{
    --bg:        #F5EFE6;
    --panel:     #FFFAF1;
    --text:      #1f2328;
    --muted:     #6f6a60;
    --accent:    #2FAF79;  /* vert principal */
    --accent-2:  #6AD3A6;  /* accent clair */
    --danger:    #B13434;
    --border:    #E4D6C5;
    --code-bg:   #0b1220;
    --code-fg:   #d6deeb;
  }
  
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    color:var(--text);
    background:var(--bg);
    font: 16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;
  }
  
  /* Layout */
  .container{
    max-width: 1100px;
    margin: 32px auto;
    padding: 0 16px;
  }
  .header h1{margin:0 0 4px 0}
  .header .muted{color:var(--muted);margin:6px 0 0}
  
  /* Cards */
  .card{
    background: var(--panel);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 18px;
    margin: 16px 0;
    box-shadow: 0 8px 26px rgba(31,35,40,.06);
  }
  .card.error{border-color: var(--danger)}
  
  /* Form */
  .form-grid{
    display:grid;
    grid-template-columns: repeat(2, minmax(0,1fr));
    gap: 14px;
  }
  .field{display:flex;flex-direction:column;gap:6px}
  .field span{font-weight:600;color:var(--muted)}
  .field input[type="text"],
  .field input[type="password"],
  .field input[type="number"],
  .field input[type="file"],
  .field select{
    appearance:none;
    width:100%;
    padding:10px 12px;
    border:1px solid var(--border);
    border-radius: 10px;
    background:#fff;color:var(--text);
    outline:none;
  }
  .field input:focus,.field select:focus{
    border-color: var(--accent);
    box-shadow: 0 0 0 4px color-mix(in srgb, var(--accent) 25%, transparent);
  }
  .span-2{grid-column: span 2}
  
  .actions{display:flex;gap:10px}
  .btn{
    display:inline-flex;align-items:center;justify-content:center;
    background: var(--accent);
    color:#000000;font-weight:700;border:none;border-radius:10px;
    padding:10px 14px;cursor:pointer;
    box-shadow: 0 10px 22px color-mix(in srgb, var(--accent) 28%, transparent);
  }
  .btn:hover{filter:brightness(1.04)}
  .btn.ghost{
    background: transparent; color: var(--accent); border:1px solid var(--accent);
  }
  
  /* Grid aux */
  .two{display:grid;grid-template-columns:1fr 1fr;gap:14px}
  @media (max-width: 860px){ .form-grid,.two{grid-template-columns:1fr} .span-2{grid-column:1} }
  
  /* Plots */
  .plots{
    display:grid;
    grid-template-columns: repeat(auto-fill,minmax(280px,1fr));
    gap:14px;
  }
  .plot{
    margin:0;background:#fff;border:1px solid var(--border);border-radius:12px;overflow:hidden;
    box-shadow: 0 8px 20px rgba(31,35,40,.05);
  }
  .plot img{display:block;width:100%;height:auto}
  
  /* Code/Logs */
  .code{
    background: var(--code-bg); color: var(--code-fg);
    border-radius: 10px; padding: 12px; overflow:auto;
  }
  .code.small{font-size: 13px}
  
  /* Small key-values */
  .kv{display:flex;align-items:center;justify-content:space-between;border-bottom:1px dashed var(--border);padding:6px 0}
  .kv:last-child{border-bottom:0}
  
  /* Misc */
  .muted{color:var(--muted)}
/* Plots — taille paramétrable */
.plots{
    display:grid;
    grid-template-columns: repeat(auto-fill, minmax(var(--plot-min, 280px), 1fr));
    gap:14px;
  }
  .plot{
    margin:0;background:#fff;border:1px solid var(--border);border-radius:12px;overflow:hidden;
    box-shadow: 0 8px 20px rgba(31,35,40,.05);
  }
  .plot img{display:block;width:100%;height:auto}
  
  /* Presets d’agrandissement (2× / 3×) */
  body.plots-2x { --plot-min: 560px; }   /* 280 ×2 */
  body.plots-3x { --plot-min: 840px; }   /* 280 ×3 */
  
  /* élargir le conteneur pour laisser respirer les grosses images */
  body.plots-2x .container{ max-width: 1400px; }  /* 1100 -> 1400 */
  body.plots-3x .container{ max-width: 1800px; }  /* 1100 -> 1800 */
  
/* Header layout */
.header-flex{
  display:flex; align-items:center; gap:16px; justify-content:space-between;
}
.app-title{ margin:0; }

/* Lang switch (top-right) */
.lang-switch{ position:relative; margin-left:auto; }
.lang-switch .btn.small{ padding:8px 12px; border-radius:10px; }
.lang-menu{
  position:absolute; right:0; top:calc(100% + 8px);
  background:#fff; border:1px solid var(--border, #E4D6C5); border-radius:12px;
  padding:6px 0; min-width:180px; box-shadow:0 10px 24px rgba(31,35,40,.12); z-index:30;
}
.lang-menu li{ list-style:none; padding:8px 12px; cursor:pointer; }
.lang-menu li:hover{ background:#F3ECE2; }

/* Dropzone (beige-green) */
.dropzone{
  border:2px dashed var(--border-strong, #C9BBAA);
  border-radius:14px; background:#fff;
  padding:22px 18px; display:flex; align-items:center; gap:16px;
  cursor:pointer; outline:none; transition: .15s ease;
}
.dropzone:hover{ box-shadow:0 8px 20px rgba(31,35,40,.06); }
.dropzone.is-dragover{
  background:#F8F4ED; border-color:#2FAF79;
  box-shadow: 0 0 0 3px rgba(47,175,121,.12) inset;
}
.dz-icon{ font-size:30px; line-height:1; }
.dz-text{ display:flex; flex-direction:column; }
.dz-text strong{ color:#2F3B2F; }
.dz-text small{ color:#6f6a60; }
.dz-filename{ margin-left:auto; font-weight:600; color:#2FAF79; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }

/* Forms */
.form-grid{ display:grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap:16px; }
.field{ display:flex; flex-direction:column; gap:8px; }
.field span{ font-weight:600; color:#2F3B2F; }
.actions{ display:flex; gap:12px; }

/* Buttons (match projet) */
.btn{
  background:#2FAF79; color:#000000; border:none; border-radius:12px;
  padding:12px 16px; cursor:pointer; font-weight:600;
  box-shadow: 0 4px 10px rgba(47,175,121,.18);
}
.btn:hover{ filter:brightness(0.95); }
.btn.ghost{
  background:#fff; color:#2F3B2F; border:1px solid var(--border, #E4D6C5);
  box-shadow:none;
}
.btn.small{ padding:8px 10px; font-size:.95rem; }

/* Plots responsive (avec presets 2x/3x) */
.plots{
  display:grid; grid-template-columns: repeat(auto-fill, minmax(var(--plot-min, 280px), 1fr)); gap:14px;
}
.plot{ margin:0; background:#fff; border:1px solid var(--border, #E4D6C5); border-radius:12px; overflow:hidden; box-shadow:0 8px 20px rgba(31,35,40,.05); }
.plot img{ display:block; width:100%; height:auto; }

body.plots-2x { --plot-min: 560px; }
body.plots-3x { --plot-min: 840px; }
body.plots-2x .container{ max-width: 1400px; }
body.plots-3x .container{ max-width: 1800px; }
/* === Language switcher : visuel de l’autre app === */
.lang-switcher{ position:relative; margin-left:auto; }
.lang-toggle{
  /* bouton rond avec fond beige-green pâle */
  width:38px;height:38px;border-radius:50%;
  border:1px solid var(--border, #E4D6C5);
  background: #FFFFFF;
  display:inline-flex;align-items:center;justify-content:center;
  box-shadow: 0 6px 18px rgba(31,35,40,.10);
  transition: transform .08s ease, box-shadow .2s ease;
  padding:0; line-height:1;
}
.lang-toggle:hover{ box-shadow:0 10px 24px rgba(31,35,40,.16); }
.lang-toggle:active{ transform: translateY(1px); }
.lang-toggle #langFlag{ font-size:18px; }

.lang-menu{
  position:absolute; right:0; top:calc(100% + 8px);
  background: rgba(255,255,255,.9);
  -webkit-backdrop-filter: blur(8px);
  backdrop-filter: blur(8px);
  border:1px solid var(--border, #E4D6C5);
  border-radius:12px; padding:6px; min-width: 200px;
  box-shadow: 0 12px 28px rgba(31,35,40,.18);
  z-index: 50;
}
.lang-menu li, .lang-menu .lang-btn{
  list-style:none; display:block; width:100%; text-align:left;
  padding:9px 10px; border-radius:8px; cursor:pointer;
  background:transparent; border:none; font:inherit;
}
.lang-menu li:hover, .lang-menu .lang-btn:hover{ background:#2FAF79; }
.lang-menu .lang-btn.active{ background:#EAF7F0; color:#218F62; }

/* === Dropzone : visuel de l’autre app === */
.upload-dropzone.dropzone{
  border: 2px dashed #C9BBAA;
  background: #FFFFFF;
  border-radius: 16px;
  padding: 22px 18px;
  display:flex; align-items:center; gap:14px;
  transition: box-shadow .2s ease, border-color .2s ease, background .2s ease;
  cursor: pointer;
}
.upload-dropzone .dz-icon{
  width:42px; height:42px; border-radius:12px;
  display:flex; align-items:center; justify-content:center;
  background:#F6F2EA; border:1px solid #E4D6C5;
  font-size:20px;
}
.upload-dropzone .dz-text strong{ color:#2F3B2F; }
.upload-dropzone .dz-text small{ color:#6F6A60; }
.upload-dropzone .dz-filename{
  margin-left:auto; font-weight:600; color:#2FAF79;
  max-width:40ch; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}
.upload-dropzone.is-dragover{
  background:#F9F6F0;
  border-color:#2FAF79;
  box-shadow: 0 0 0 3px rgba(47,175,121,.12) inset, 0 10px 26px rgba(31,35,40,.10);
}

/* accessibilité */
.sr-only{ position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,1px,1px); border:0; }
/* alias si tu laisses "over" côté JS */
.dropzone.over{ 
  background:#F8F4ED; border-color:#2FAF79;
  box-shadow: 0 0 0 3px rgba(47,175,121,.12) inset;
}

/* alias pour anciens scripts */
.dropzone.over{
  background:#F8F4ED; border-color:#2FAF79;
  box-shadow: 0 0 0 3px rgba(47,175,121,.12) inset;
  }
  
  /* cacher l'input fichier tout en gardant les events */
  .visually-hidden{
  position:absolute !important;
  width:1px; height:1px; padding:0; margin:-1px;
  overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0;
  }


     .plots{
       display:grid;
       grid-template-columns: repeat(auto-fit, minmax(var(--plot-min, 280px), 1fr));
       gap:14px;
     }
     
     .plot{

      margin:0; background:#fff; border:1px solid var(--border);
      border-radius:12px; overflow:hidden; box-shadow:0 8px 20px rgba(31,35,40,.05);
      /* carré responsive */
      aspect-ratio: 1 / 1;
      position: relative; /* pour le bouton overlay */
     }
    .plot img{
      display:block;
      width:100%;
      height:100%;           /* ← prend toute la tuile */
      object-fit: contain;   /* ← pas de crop ; mets 'cover' si tu préfères recadrer */
    }
    
    /* Bouton télécharger overlay */
    .plot .dl-btn{
      position:absolute; right:10px; top:10px;
      padding:6px 10px; border-radius:8px;
      background: rgba(255,255,255,.9);
      border:1px solid var(--border);
      text-decoration:none; font-weight:600; font-size:.9rem;
      box-shadow: 0 6px 16px rgba(31,35,40,.12);
    }
    .plot .dl-btn:hover{ filter:brightness(.98); }


    /* --- Bouton de téléchargement flottant sur le plot --- */
.plot { position: relative; } /* ancre l'absolute */

.plot .dl-fab{
  position: absolute;
  top: 8px;
  right: 8px;
  z-index: 2;
  padding: 6px 10px;
  opacity: 0;                  /* caché par défaut */
  transform: translateY(-4px); /* petit effet d'entrée */
  box-shadow: var(--shadow, 0 2px 8px rgba(0,0,0,.15));
  transition: opacity .15s ease, transform .15s ease;
}

/* Afficher au survol ou au focus clavier */
.plot:hover .dl-fab,
.plot:focus-within .dl-fab{
  opacity: 1;
  transform: none;
}

/* Sur mobile (pas de hover), affiche toujours */
@media (hover: none){
  .plot .dl-fab{ opacity: 1; transform: none; }
}

/* Sécurité : l'image remplit la largeur et garde le ratio */
.plot > img{ width: 100%; height: auto; display: block; }

.density-switch{display:flex;gap:6px;background:#fff;border:1px solid var(--border);
  border-radius:12px;padding:4px;box-shadow:0 10px 24px rgba(31,35,40,.10)}
.density-switch .seg{background:transparent;border:0;padding:6px 10px;border-radius:8px;
  cursor:pointer;font-weight:600}
.density-switch .seg.active{background:#EAF7F0;color:#218F62}

.lightbox{position:fixed;inset:0;z-index:1000;background:rgba(0,0,0,.6);
  display:flex;align-items:center;justify-content:center;backdrop-filter:blur(2px)}
.lightbox-content{position:relative}
.lightbox img{max-width:95vw;max-height:85vh;border-radius:12px;
  box-shadow:0 20px 60px rgba(0,0,0,.35)}
.lightbox .close{position:absolute;top:-10px;right:-10px;width:36px;height:36px;
  border-radius:50%;border:1px solid var(--border);background:#fff;cursor:pointer;
  display:flex;align-items:center;justify-content:center;font-size:20px}

  